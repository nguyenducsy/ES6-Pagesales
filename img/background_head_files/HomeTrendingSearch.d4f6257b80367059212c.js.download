(("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[]).push([[105],{1061:function(e,t,n){"use strict";n.d(t,"c",function(){return a});n(260),n(222);var r=n(868);n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return r.b}),n.d(t,"d",function(){return r.d}),n.d(t,"e",function(){return r.g}),n.d(t,"f",function(){return r.h}),n.d(t,"g",function(){return r.j}),n.d(t,"h",function(){return r.k});var a=function(e){return Object(r.b)(e,{symbol:""})}},1977:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(21),a=Object(r.b)();var o=1e3;switch(a){case"TW":o=1e4;break;default:o=1e3}function i(e,t,n){return void 0===n&&(n=o),e(t,0)+(t>=n?"+":"")}},2478:function(e,t,n){e.exports={container:"_2_cF1E",infoWrapper:"_1l0-y9",info:"_3b4xmZ",keyword:"ENggsg",productCount:"iOZi_8",image:"_1yowc-",imageWrapper:"IOkwB7"}},2479:function(e,t,n){e.exports={item:"_288_oV"}},3484:function(e,t,n){e.exports={section:"W6h8fB"}},3493:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(71),i=n(54),c=n(1142),s=n(119),u=n(118);function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f=function(e){return a.a.createElement("svg",l({viewBox:"0 0 12 15"},e),a.a.createElement("path",{d:"M12 7.51268255c0-1.71021918-.7226562-3.30538371-1.9648437-4.43447938-.20507817-.18525749-.52148442-.16965686-.7070313.03315134-.18554687.20475828-.16992188.52067106.03320313.70592856C10.3984375 4.75722109 11 6.08717488 11 7.51268255c0 2.59360495-1.98242187 4.72699125-4.515625 4.96880095l.68164063-.7878318c.1796875-.2086585.15625-.5245713-.05273438-.7039785-.20898438-.1794073-.52539062-.1560063-.70507813.0526521l-1.49609375 1.7336201c-.18164062.2106086-.15625.5284714.05664063.7078787l1.65429688 1.3982065c.21093749.1774572.52539062.1521062.70507812-.0585023.17773438-.2106085.15234375-.5245712-.05859375-.7039785l-.75195313-.6357257C9.58789062 13.2205634 12 10.6484094 12 7.51268255zM2.80273438 11.3523879C1.66796875 10.4085497 1 9.0161934 1 7.51463263c0-2.75741154 2.23828125-4.99220194 5-4.99220194h.01367188l-.7734375.75078037c-.19726563.19305781-.203125.50897059-.00976563.70592855.19335938.19695797.50976563.20280821.70703125.0097504l1.64257813-1.59516453c.19921875-.19305781.20117187-.51287074.00585937-.70982871L6.06054688.14723461c-.1953125-.19500789-.51171875-.19695797-.70703125-.00195008C5.15820313.34029242 5.15625.6562052 5.3515625.85121309l.66992188.67472729H6c-3.31445312 0-6 2.68135846-6 5.99064232 0 1.8018729.80273438 3.4750406 2.16210938 4.6060863.21289062.1755071.52734375.148206.70507812-.0643526.17773438-.2164587.1484375-.5304214-.06445312-.7059285z",fillRule:"nonzero"}))},d=Object(u.a)({Icon:f,iconClassNames:["icon-refresh"]}),p=n(5),m=n(73),h=n(258),v=n(224),E=n(3484),b=n.n(E),y={linkTo:"#",text:""},_=function(e){var t=e.children,n=e.showHeaderButton,a=e.onChangeClick;return r.createElement(s.a,{targetType:"HomePersonalizedTrendingSearch"},r.createElement(h.a.Consumer,null,function(e){var o=e.customHeader;return r.createElement(c.a,{headerText:r.createElement("span",null,Object(m.t)("label_trending_searches")),headerButton:n?y:null,onHeaderButtonClick:a,customButtonContent:r.createElement(r.Fragment,null,r.createElement(d,null),"Â ",Object(m.t)("label_trending_search_change")),simpleVersion:!0,hasNoNavigation:!0,classNames:b.a.section,customHeader:Object(p.a)(o,[v.FESTIVAL_CUSTOM_HEADERS.TRENDING_SEARCH])},t)}))},g=n(40),S=n.n(g),O=n(866),C=n(2478),k=n.n(C),N=function(e){var t=e.className;return r.createElement("div",{className:S()(k.a.container,t||"")},r.createElement("div",{className:k.a.info},r.createElement("div",{className:S()(k.a.keyword,"skeleton skeleton--medium")}),r.createElement("div",{className:S()(k.a.productCount,"skeleton skeleton--medium")})),r.createElement(O.a,{className:k.a.image,wrapperClassName:k.a.imageWrapper,src:""}))};var w=function e(t){return(t=Math.round(t))<0?-1:0===t?1:t*e(t-1)}(3)-1,j=n(2479),R=n.n(j),I=new Array(5).fill(),x=function(){return r.createElement(_,{showHeaderButton:!1},I.map(function(e,t){return r.createElement(N,{key:t,className:R.a.item})}))},T=n(374),H=n(1061),A=n(104),D=n(309),F=n(1393),M=n(305),B=n(1977),W="HomePersonalizedTrendingSearchItem",L=function(e){var t=e.keyword,n=e.count,a=e.image,o=e.className,i=Object(F.a)(W,e),c=Object(M.a)(W,e),s=Object(A.searchKeyword)(t);return r.createElement(T.a,{to:s,className:S()(k.a.container,o||""),onClick:c,innerRef:i},r.createElement("div",{className:k.a.infoWrapper},r.createElement("div",{className:k.a.info},r.createElement("div",{className:k.a.keyword},t),r.createElement("div",{className:k.a.productCount},Object(m.t)("label_n_products_plural",{count:Object(B.a)(H.h,n||0)})))),r.createElement(O.a,{className:k.a.image,wrapperClassName:k.a.imageWrapper,src:Object(D.a)(a)}))};function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var z,P,Q=function(e){return function(t){var n,a;function o(e){var n;return(n=t.call(this,e)||this).state={isShuffled:!1},n.onShuffle=n.onShuffle.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n)),n}a=t,(n=o).prototype=Object.create(a.prototype),n.prototype.constructor=n,n.__proto__=a;var i=o.prototype;return i.onShuffle=function(){this.setState({isShuffled:!0})},i.render=function(){var t=this.props.isLoaded,n=U({shouldShuffle:!this.state.isShuffled&&t,onShuffle:this.onShuffle},this.state,this.props);return r.createElement(e,n)},o}(r.Component)},G=n(22),K=n(256),V=n(11),J=n(1),Z=Object(J.b)("FETCH_TRENDING_SEARCH"),q="SHUFFLE_TRENDING_SEARCH",X="SET_TRENDING_SEARCH",Y="pts_sec";function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var ee={progress:V.b.INIT,state_update_time:0,error:0},te={current_index:0,update_time:0,version:"",sections:(z={},z[Y]={total:0,data:[]},z)},ne=Object(G.a)(((P={})[Z.REQUESTED]=function(e){return $({},e,{progress:V.b.REQ,error:0,state_update_time:0})},P[Z.SUCCESS]=function(e,t){var n,r=t.payload,a=r.offset,o=r.data,i=r.defaultIndex,c=r.shouldReset,s=e&&e.data||te;return o.version&&s.version===o.version?$({},e,{progress:V.b.OK,state_update_time:Date.now()}):$({},e,{data:$({},s,{update_time:o.update_time,current_index:i,version:o.version,sections:$({},s.sections,(n={},n[Y]={total:o.sections[Y].total,data:Object(K.b)(c?[]:s.sections[Y].data,o.sections[Y].data,a)},n))}),progress:V.b.OK,state_update_time:Date.now()})},P[Z.FAILED]=function(e,t){var n=t.payload.error;return $({},e,{progress:V.b.ERR,error:n})},P[q]=function(e,t){var n=t.payload.offset;return e.data?$({},e,{data:$({},e.data,{current_index:(e.data.current_index+n)%e.data.sections[Y].data.length})}):e},P[X]=function(e,t){return t.payload.store},P),ee),re=n(38),ae=n(14),oe=n(2),ie="/api/v4/recommend/recommend";function ce(e){return Object(oe.fetchInfo)(""+ie+e)}function se(e,t){var n,r={current_index:0,update_time:e.data.update_time,version:e.data.version,sections:(n={},n[Y]={total:0,data:[]},n)},a=e.data.sections.find(function(e){return e&&e.key===t});if(!a)return r;var o=a.index,i=a.data,c=a.total;return r.sections[Y].total=c||0,o&&i.keyword?(o.forEach(function(e){var t=i.keyword.find(function(t){return t.key===e.key});t&&r.sections[Y].data.push(t)}),r):r}function ue(e){return function(t){var n=e(t);return!(!n||!n.state_update_time&&n.progress!==V.b.REQ)&&n.state_update_time>Date.now()-6e4}}function le(e){return{type:q,payload:{offset:e}}}var fe=[];var de=n(246),pe=n(37),me=n(397);var he=new Array(5).fill(0),ve=[V.b.INIT,V.b.REQ],Ee="@shopee/rcmd-trending-search",be=pe.a.isSupported();function ye(e){return e[me.o]}function _e(){return he.map(function(){return e=0,t=w,e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e;var e,t})}t.default=Object(i.d)(Q,de.c,Object(o.connect)())(function(e){var t=e.shouldShuffle,n=e.onShuffle,a=e.injectAsyncReducer,i=e.dispatch;r.useEffect(function(){var e;a(((e={})[me.o]=ne,e));var t=be&&pe.a.get(Ee)||null;t&&i({type:X,payload:{store:t}})},[i,a]);var c=r.useState(_e()),s=c[0],u=c[1],l=r.useCallback(function(){u(_e())},[]);r.useEffect(function(){var e,t,n,r,a,o,c,s,u,l,f,d,p;i((t=(e={offset:0,limit:20,defaultIndex:-5,getStore:ye}).limit,n=void 0===t?20:t,r=e.offset,a=void 0===r?0:r,o=e.defaultIndex,c=void 0===o?0:o,s=e.getStore,u=e.onFinish,l=e.shouldSkipCall,f=e.shouldReset,d=e.version,p=Object(ae.f)({bundle:"trending_search",limit:n,offset:a,version:a>0&&d||void 0}),Object(re.a)({apiCall:function(){return ce(p)},actions:[function(){return{type:Z.REQUESTED}},function(e,t){return{type:Z.SUCCESS,payload:{offset:a,data:se(t,Y),defaultIndex:c,shouldReset:f}}},function(e,t){return{type:Z.FAILED,payload:{error:t.error}}}],shouldSkipCall:s&&!l?ue(s):l,onFinish:u})))},[i]);var f,d=r.useCallback(function(){i(le(5)),l()},[i,l]),p=Object(o.useSelector)(ye),m=ve.includes((f=p)?f.progress:V.b.INIT);r.useEffect(function(){!m&&t&&(n(),i(le(5)),l())},[i,m,n,t,l,p]),r.useEffect(function(){var e;e=p,be&&pe.a.set(Ee,e)},[p]);var h=r.useMemo(function(){return function(e,t){if(!e||!e.data)return fe;var n=e.data,r=n.current_index,a=n.sections,o=Math.max(r,0),i=o+t,c=a[Y].data;return c.length<=t?c:i>c.length?[].concat(c,c).slice(o,i):c.slice(o,i)}(p,5)},[p]);if(m)return r.createElement(x,null);var v=function(e){return e&&e.data?e.data.sections[Y].total:0}(p);return!h||v<5?null:r.createElement(_,{showHeaderButton:v>5,onChangeClick:d},h.map(function(e,t){var n=e&&Array.isArray(e.images)?e.images.length:0,a=n>0?s[t]%n:0,o=e&&e.keyword?e.keyword:t;return r.createElement(L,{key:o,keyword:e.keyword||"",count:e.count,image:Array.isArray(e.images)?e.images[a]:"",className:R.a.item,index:t,info:e.info,conceptid:e.intentionid})}))})}}]);
//# sourceMappingURL=https://shopee.sg/assets/HomeTrendingSearch.d4f6257b80367059212c.js.map