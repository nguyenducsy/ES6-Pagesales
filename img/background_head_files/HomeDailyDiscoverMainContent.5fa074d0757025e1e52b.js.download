(("undefined"!=typeof self?self:this).webpackJsonp=("undefined"!=typeof self?self:this).webpackJsonp||[]).push([[97],{1327:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});var i,a=n(1),r=Object(a.b)("FETCH_DAILY_DISCOVER_MAIN");!function(t){t.Item="item",t.Ads="ads",t.Collection="collection",t.TopProduct="top_product",t.Keyword="keyword",t.L2Cat="l2cat",t.Shop="shop"}(i||(i={}))},1708:function(t,e,n){"use strict";var i=n(1721);n.d(e,"fetchBffDailyDiscoverMain",function(){return i.a}),n.d(e,"fetchDailyDiscoverMain",function(){return i.b});n(1327);var a=n(1709);n.d(e,"dailyDiscoverMainReducer",function(){return a.a});var r=n(1710);n.d(e,"getDailyDiscoverItemsOnly",function(){return r.a}),n.d(e,"getDailyDiscoverUnits",function(){return r.b}),n.d(e,"getTotal",function(){return r.c}),n.d(e,"hasUnitsInRange",function(){return r.d});n(1711)},1709:function(t,e,n){"use strict";n.d(e,"a",function(){return d});var i,a=n(22),r=n(256),o=n(11),c=n(1327);function u(){return(u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var s={progress:o.b.INIT,error:0},d=Object(a.a)(((i={})[c.b.REQUESTED]=function(t){return u({},t,{progress:o.b.REQ})},i[c.b.SUCCESS]=function(t,e){var n=e.payload,i=n.data,a=n.offset,c=n.shouldReset,s=t.data||i;return u({},t,{data:u({},s,{sections:u({},s.sections,{dd_main_sec:u({},s.sections.dd_main_sec,{data:c?i.sections.dd_main_sec.data:Object(r.b)(t.data?t.data.sections.dd_main_sec.data:[],i.sections.dd_main_sec.data,a)})})}),progress:o.b.OK})},i[c.b.FAILED]=function(t,e){return u({},t,{error:e.payload.error,progress:o.b.ERR})},i),s)},1710:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return c}),n.d(e,"c",function(){return u}),n.d(e,"d",function(){return s});var i=n(1327),a=[];function r(t,e){if(!t||!t.data)return a;if(!e||!e.limit&&!e.offset)return t.data.sections.dd_main_sec.data;var n=e.offset,i=void 0===n?0:n,r=e.limit;return t.data.sections.dd_main_sec.data.slice(i,"number"==typeof r?r+i:void 0)}function o(t){return[i.a.Item,i.a.Ads].includes(t.data_type)}function c(t,e){return r(t,e).filter(o)}function u(t){return t&&t.data?t.data.sections.dd_main_sec.total:0}function s(t,e,n){if(!t||!t.data)return!1;var i=t.data.sections.dd_main_sec,a=i.data,r=i.total,o=e+n>r?r%n:n;return a.slice(e,e+n).filter(function(t){return t}).length===o}},1711:function(t,e){},1721:function(t,e,n){"use strict";n.d(e,"b",function(){return m}),n.d(e,"a",function(){return p});var i=n(38),a=n(14),r=n(2);var o=n(1327);function c(){return(c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function u(t){var e=t.data,n=e.update_time,i=e.sections.dd_main_sec||{index:[],data:null,total:0};return d({index:i.index,data:i.data,total:i.total,update_time:n})}function s(t){var e=t.data,n=e.update_time,i=e.sections,a=e.version,r=i.find(function(t){return"dd_main_sec"===t.key});return r?d({index:r.index,data:r.data,total:r.total,update_time:n,version:a}):l(n,a)}function d(t){var e=t.index,n=t.data,i=t.total,a=t.update_time,r=t.version;if(!e||!n)return l(a,r);var c=[];return e.forEach(function(t){var e=function(t,e){var n=e.data_type,i=(t&&t[n]||[]).find(function(t){return t.key===e.key});switch(n){case o.a.Collection:return i?(r=(a=i).key,c=a.collection_id,u=a.collectionid,s=a.name,d=a.page_template_image,l=a.images,m=void 0===l?[]:l,p=a.sold,_=a.info,v=a.from,y=a.data_type,{key:r,collectionId:c||u,name:s,image:d,images:m,sold:p,recommendation_info:_,recommendation_algorithm:v,data_type:y}):void 0;case o.a.TopProduct:return i?function(t){var e=t.key,n=t.intentionid,i=t.label,a=t.name,r=t.images,o=t.count,c=t.info,u=t.from,s=t.data_type;return{key:e,topProductId:n||i||"",name:a,image:r?r[0]:null,sold:o,recommendation_info:c,recommendation_algorithm:u,data_type:s}}(i):void 0;case o.a.Item:return i?f(i):void 0;default:return i}var a,r,c,u,s,d,l,m,p,_,v,y}(n,t);e&&c.push(e)}),{update_time:a,sections:{dd_main_sec:{total:i,data:c}}}}var f=function(t){return c({},t,{label_ids:t.label_ids||[]})};function l(t,e){return{update_time:t||0,version:e||void 0,sections:{dd_main_sec:{total:0,data:[]}}}}function m(t){var e=t.limit,n=t.offset,c=t.onFinish,s=t.shouldSkipCall,d=t.shouldReset,f=Object(a.f)({dd_main_sec_limit:e,dd_main_sec_offset:n});return Object(i.a)({apiCall:function(){return function(t){return Object(r.fetchInfo)("/api/v2/recommendation/bundle/daily_discover_main"+t)}(f)},actions:[function(){return{type:o.b.REQUESTED}},function(t,e){return{type:o.b.SUCCESS,payload:{offset:n,data:u(e),shouldReset:d}}},function(t,e){return{type:o.b.FAILED,payload:{error:e.error}}}],shouldSkipCall:s,onFinish:c})}function p(t){var e=t.limit,n=t.offset,c=t.itemCardStyle,u=t.onFinish,d=t.shouldSkipCall,f=t.shouldReset,l=Object(a.f)({bundle:"daily_discover_main",limit:e,offset:n,item_card:c});return Object(i.a)({apiCall:function(){return function(t){return Object(r.fetchInfo)("/api/v4/recommend/recommend"+t)}(l)},actions:[function(){return{type:o.b.REQUESTED}},function(t,e){return{type:o.b.SUCCESS,payload:{offset:n,data:s(e),shouldReset:f}}},function(t,e){return{type:o.b.FAILED,payload:{error:e.error}}}],shouldSkipCall:d,onFinish:u})}},1996:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var i=n(0),a=n(71),r=n(1708);n(11);var o={};function c(t){var e=t.limit,n=t.offset,c=t.isItemOnly,u=t.itemCardStyle,s=t.forceRefetch,d=t.getDailyDiscoverMainStore,f=Object(a.useDispatch)(),l=i.useState(n||0),m=l[0],p=l[1],_=i.useMemo(function(){return m+"-"+(m+e)},[m,e]),v=i.useCallback(function(){return!s&&!!o[_]},[s,_]),y=i.useCallback(function(){o[_]||(o[_]=!0)},[_]);i.useEffect(function(){f(Object(r.fetchBffDailyDiscoverMain)({offset:m,limit:e,itemCardStyle:u,shouldSkipCall:v,onFinish:y}))},[m,f,u,e,y,v]);var b=i.useCallback(function(t){p(t)},[]),h=Object(a.useSelector)(function(t){return d(t)});return{items:i.useMemo(function(){return c?Object(r.getDailyDiscoverItemsOnly)(h,{limit:e,offset:n}):Object(r.getDailyDiscoverUnits)(h,{limit:e,offset:n})},[c,e,n,h]),total:Object(r.getTotal)(h),limit:e,offset:m,store:h,loadPage:b}}},3621:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n(71),r=n(54),o=n(2338),c=n(393),u=n(1708),s=n(1996),d=n(1165),f=n(397),l=n(11),m=n(9);var p=[l.b.INIT,l.b.REQ];function _(t){return t[f.c]}e.default=Object(r.d)(c.b,Object(a.connect)())(function(t){var e=t.recommendType,n=t.tabId,a=t.isUserAdult,r=t.isBff,c=t.injectAsyncReducer;i.useEffect(function(){var t;c(((t={})[f.c]=u.dailyDiscoverMainReducer,t))},[c]);var l=Object(s.a)({limit:f.l.DAILY_DISCOVER_BATCH_SIZE,getDailyDiscoverMainStore:_,isItemOnly:!0,isBff:r,itemCardStyle:m.d.SIMPLIFIED_COUNT}),v=l.items,y=l.total,b=l.store,h=i.useMemo(function(){return Object(d.a)(v).slice(0,f.l.DAILY_DISCOVER_DISPLAY_SIZE)},[v]),D=!b||p.includes(b.progress);return i.createElement(o.a,{items:h,total:y,loading:D,isUserAdult:a,tabId:n,recommendType:e})})}}]);
//# sourceMappingURL=https://shopee.sg/assets/HomeDailyDiscoverMainContent.5fa074d0757025e1e52b.js.map